# 价格表管理功能演示

## 🎯 功能概述

价格表管理功能允许用户在上传价格表后，通过Web界面直接查看、编辑和管理价格表内容，支持完整的增删改查操作。

## 📋 功能特性

### ✅ 已实现功能
- **价格表列表显示** - 显示用户上传的所有价格表文件
- **表格内容查看** - 以表格形式显示价格表的完整内容
- **单元格编辑** - 点击单元格可直接编辑内容
- **行操作** - 添加新行、删除指定行
- **列操作** - 添加新列、删除指定列
- **文件操作** - 删除整个价格表文件
- **数据保存** - 保存修改后的表格数据到文件

## 🚀 使用方法

### 1. 启动服务

```bash
# 启动后端服务
cd quote-system/backend
python main.py

# 启动前端服务（新终端）
cd quote-system/frontend
python -m http.server 8000
```

### 2. 访问界面

1. 打开浏览器访问：`http://localhost:8000/index.html`
2. 使用管理员账户登录：`admin` / `admin123`
3. 点击"价格表管理"标签页

### 3. 功能操作

#### 📁 查看价格表列表
- 左侧显示所有上传的价格表文件
- 点击文件名可查看其内容

#### 📊 查看表格内容
- 右侧显示选中价格表的完整内容
- 表格包含所有列和行数据

#### ✏️ 编辑单元格
- 点击任意单元格进入编辑模式
- 输入新内容后按回车或点击其他地方保存

#### ➕ 添加新行
- 点击"➕ 添加行"按钮
- 在弹出的对话框中填写各列数据
- 点击"确定"添加新行

#### ➕ 添加新列
- 点击"➕ 添加列"按钮
- 输入新列名
- 点击"确定"添加新列

#### 🗑️ 删除行/列
- **删除行**：点击行末的"删除"按钮
- **删除列**：点击列头的"×"按钮

#### 💾 保存数据
- 点击"💾 保存"按钮保存所有修改
- 数据将保存到原始Excel文件中

#### 🔄 刷新数据
- 点击"🔄 刷新"按钮重新加载表格数据

## 🧪 测试验证

### 后端API测试

```bash
# 测试文件列表API
python test_api_simple.py

# 测试价格表内容获取
python test_price_content.py

# 完整功能测试
python test_price_table_manager.py
```

### 测试结果示例

```
🧪 测试文件列表API...
状态码: 200
✅ API调用成功
价格表文件数量: 13
价格表文件列表: ['666.xlsx', '3 (2)_01.xlsx', '123.xlsx', ...]

🧪 测试价格表内容获取...
状态码: 200
✅ 价格表内容获取成功
列数: 5
行数: 9
列名: ['产品名称', '型号', '规格', '单价', '品牌']
```

## 📁 文件结构

```
quote-system/
├── backend/
│   ├── main.py                    # 后端API服务
│   ├── test_api_simple.py         # API测试脚本
│   ├── test_price_content.py      # 内容获取测试
│   └── test_price_table_manager.py # 完整功能测试
├── frontend/
│   ├── app.js                     # 前端应用（包含价格表管理组件）
│   └── index.html                 # 主页面
└── merchant_data/
    └── admin/
        └── 价格表/                # 用户上传的价格表文件
            ├── 666.xlsx
            ├── 123.xlsx
            └── ...
```

## 🔧 API接口

### 获取文件列表
```
GET /api/files
```

### 获取价格表内容
```
GET /api/price-table/{filename}
```

### 更新价格表内容
```
POST /api/price-table/{filename}/update
```

### 添加新行
```
POST /api/price-table/{filename}/add-row
```

### 更新指定行
```
PUT /api/price-table/{filename}/row/{row_index}
```

### 删除指定行
```
DELETE /api/price-table/{filename}/row/{row_index}
```

### 添加新列
```
POST /api/price-table/{filename}/add-column
```

### 删除指定列
```
DELETE /api/price-table/{filename}/column/{column_name}
```

### 删除价格表
```
DELETE /api/price-table/{filename}
```

## 🎨 界面截图

价格表管理界面包含：
- **左侧**：价格表文件列表，支持选择文件
- **右侧**：表格内容显示和编辑区域
- **工具栏**：添加行、添加列、保存、刷新等操作按钮
- **表格**：可编辑的表格，支持单元格编辑

## ✅ 功能验证

1. ✅ 价格表列表正确显示
2. ✅ 表格内容正确加载
3. ✅ 单元格编辑功能正常
4. ✅ 添加行功能正常
5. ✅ 添加列功能正常
6. ✅ 删除行功能正常
7. ✅ 删除列功能正常
8. ✅ 数据保存功能正常
9. ✅ 文件删除功能正常

## 🎉 总结

价格表管理功能已完全实现并测试通过，用户可以：

- 查看所有上传的价格表文件
- 直接编辑价格表内容
- 添加/删除行和列
- 保存修改到原始文件
- 删除不需要的价格表文件

这为用户提供了完整的价格表管理能力，无需下载文件进行编辑，大大提升了使用体验！ 